% === Generic environments, used by other environments ===

\newenvironment{EnvWithBoxTitle}[1]{%
\par
\vspace{12pt}
\hrule
\vspace{-12pt}
\subsubsection*{#1}
}{%
\par
\vspace{4pt}
\hrule
\vspace{12pt}
}

\newenvironment{EnvWithTitle}[1]{%
\subsubsection*{#1}
}{%
}

% === CNXML+ environments ===

\newenvironment{ActivityActivity}[1]{%
\begin{EnvWithBoxTitle}{Activity: #1}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{ActivityFormalexperiment}[1]{%
\begin{EnvWithBoxTitle}{Formal Experiment: #1}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{ActivityGeneralexperiment}[1]{%
\begin{EnvWithBoxTitle}{General Experiment: #1}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{ActivityGroupdiscussion}[1]{%
\begin{EnvWithBoxTitle}{Group Discussion: #1}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{ActivityInformalexperiment}[1]{%
\begin{EnvWithBoxTitle}{Informal Experiment: #1}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{ActivityInvestigation}[1]{%
\begin{EnvWithBoxTitle}{Investigation: #1}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{ActivitySection}[1]{%
\begin{EnvWithTitle}{#1:}%
}{%
\end{EnvWithTitle}%
}

\newenvironment{Definition}[1]{%
\begin{EnvWithBoxTitle}{Definition: #1}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{Exercises}{%
\begin{EnvWithBoxTitle}{Exercises}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{ExercisesEntry}{}{}

\newenvironment{ExercisesEntryProblem}{%
\begin{EnvWithTitle}{Problem:}%
}{%
\end{EnvWithTitle}%
}

\newenvironment{ExercisesEntrySolution}{%
\begin{EnvWithTitle}{Solution:}%
}{%
\end{EnvWithTitle}%
}

\newenvironment{ExercisesProblemset}{%
\begin{ExercisesEntryProblem}%
}{%
\end{ExercisesEntryProblem}%
}

\newenvironment{ExercisesProblemsetHeader}{}{}

\newenvironment{ExercisesProblemsetFooter}{}{}

\newenvironment{ExercisesProblemsetEntries}{%
\begin{enumerate}%
}{%
\end{enumerate}%
}

\newenvironment{ExercisesProblemsetEntry}{}{}

\newenvironment{ExercisesProblemsetEntryProblem}{%
\item %
}{%
}

\newenvironment{FigureFigure}{%
\begin{figure}[h!]%
}{%
\end{figure}%
}

\newenvironment{FigureTable}{%
\begin{table}[h!]%
}{%
\end{table}%
}

\newenvironment{ListBulleted}{%
\begin{itemize}%
}{%
\end{itemize}%
}

\newenvironment{ListEnumerated}{%
\begin{enumerate}%
}{%
\end{enumerate}%
}

\newenvironment{Mathextension}{%
\begin{EnvWithBoxTitle}{Extension}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{Mathidentity}{%
\begin{EnvWithBoxTitle}{Identity}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{NoteAside}{%
\begin{EnvWithBoxTitle}{Aside}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{NoteTip}{%
\begin{EnvWithBoxTitle}{Tip}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{NoteWarning}{%
\begin{EnvWithBoxTitle}{Warning}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{Theorem}[1]{%
\begin{EnvWithBoxTitle}{#1}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{TheoremStatement}[1]{%
\begin{EnvWithTitle}{Statement:}%
}{%
\end{EnvWithTitle}%
}

\newenvironment{TheoremGiven}[1]{%
\begin{EnvWithTitle}{Given:}%
}{%
\end{EnvWithTitle}%
}

\newenvironment{TheoremRequired}[1]{%
\begin{EnvWithTitle}{Required:}%
}{%
\end{EnvWithTitle}%
}

\newenvironment{TheoremProof}[1]{%
\begin{EnvWithTitle}{Proof:}%
}{%
\end{EnvWithTitle}%
}

\newenvironment{Workedexample}[1]{%
\begin{EnvWithBoxTitle}{Worked Example: #1}%
}{%
\end{EnvWithBoxTitle}%
}

\newenvironment{WorkedexampleAnswer}{%
\begin{EnvWithTitle}{Answer}%
}{%
\end{EnvWithTitle}%
}

\newenvironment{WorkedexampleAnswerWorkstep}[1]{%
\begin{EnvWithTitle}{Step: #1}%
}{%
\end{EnvWithTitle}%
}

\newenvironment{WorkedexampleQuestion}{%
\begin{EnvWithTitle}{Question}%
}{%
\end{EnvWithTitle}%
}

\newenvironment{alignrll}{%
\begin{array}{r@{\;}l@{\qquad}l}%
}{%
\end{array}%
}
